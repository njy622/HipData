{% extends "base.html" %}
{% block addtional_head %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSV 데이터 모달로 표시하기</title>
    <!-- 부트스트랩 CSS 링크 추가 -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
</head>
{% endblock %}

{% block content %}
    <!-- 모달 버튼 -->
    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#csvModal" id='NH투자증권'>
    <img src="../static/img/NH투자증권.jpg" width="300px" height="100px">
    NH투자증권
    </button>
    <br><br>
    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#csvModal" id='하나증권'>
    <img src="../static/img/하나증권.jpg" width="300px" height="100px">
    하나증권
    </button>
    <br><br>
    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#csvModal" id='KB증권'>
    <img src="../static/img/KB증권.png" width="300px" height="100px">
    KB증권
    </button>
    <br><br>
    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#csvModal" id='신한투자증권'>
    <img src="../static/img/신한투자증권.jpg" width="300px" height="100px">
    신한투자증권
    </button>
    <br><br>

    <!-- CSV 데이터를 표시할 모달 창 -->
    <div class="modal fade" id="csvModal" tabindex="-1" role="dialog" aria-labelledby="csvModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="csvModalLabel">CSV 데이터</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <table id="csvTable" class="table">
                        <!-- CSV 데이터는 여기에 표시될 것입니다. -->
                        <thead>
                            <tr>
                                <th>증권사</th>
                                <th>제목</th>
                                <th>코드</th>
                                <th>위험군</th>
                                <th>펀드규모</th>
                                <th>3개월 수익률</th>
                                <th>링크</th>
                            </tr>
                        </thead>
                        <tbody id="modalBody">
                            <!-- 테이블 내용은 JavaScript로 채워집니다. -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">닫기</button>
      </div>
    </div>
  </div>
</div>
</tbody>
</table>
</div>

    <!-- 부트스트랩 JS 및 jQuery, Popper.js 스크립트 추가 -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>


    <script>
    // 농협증권 버튼 클릭 이벤트를 감지하고 모달에 CSV 데이터를 불러와서 표시하는 함수
    document.getElementById('NH투자증권').addEventListener('click', async function() {
    const response = await fetch('../static/data/증권사상품.csv'); // CSV 파일 경로
    const csvData = await response.text();
    
    // CSV 데이터를 파싱하여 배열로 변환
    const rows = csvData.split('\n').map(row => row.split(','));

    // 특정 조건에 맞는 데이터 필터링 (예: Product ID가 1인 경우)
    const filteredRows = rows.filter(row => row[1] === 'NH투자증권'); // 첫 번째 열이 Product ID
    // 모달에 테이블로 데이터 출력
    const modalBody = document.getElementById('modalBody');
    modalBody.innerHTML = '';

    filteredRows.forEach(row => {
        const newRow = document.createElement('tr');
        newRow.innerHTML = `<td>${row[1]}</td><td>${row[2]}</td><td>${row[4]}</td><td>${row[5]}</td><td>${row[6]}</td><td>${row[7]}</td><td>${row[3]}</td>`;
        modalBody.appendChild(newRow);
    });

    // 모달 표시
    $('#productModal').modal('show');
    });

    // 하나증권 버튼 클릭 이벤트를 감지하고 모달에 CSV 데이터를 불러와서 표시하는 함수
    document.getElementById('하나증권').addEventListener('click', async function() {
    const response = await fetch('../static/data/증권사상품.csv'); // CSV 파일 경로
    const csvData = await response.text();
    
    // CSV 데이터를 파싱하여 배열로 변환
    const rows = csvData.split('\n').map(row => row.split(','));

    // 특정 조건에 맞는 데이터 필터링 (예: Product ID가 1인 경우)
    const filteredRows = rows.filter(row => row[1] === '하나증권'); // 첫 번째 열이 Product ID
    // 모달에 테이블로 데이터 출력
    const modalBody = document.getElementById('modalBody');
    modalBody.innerHTML = '';

    filteredRows.forEach(row => {
        const newRow = document.createElement('tr');
        newRow.innerHTML = `<td>${row[1]}</td><td>${row[2]}</td><td>${row[4]}</td><td>${row[5]}</td><td>${row[6]}</td><td>${row[7]}</td><td>${row[3]}</td>`;
        modalBody.appendChild(newRow);
    });
    // 모달 표시
    $('#productModal').modal('show');
    });

    // KB증권 버튼 클릭 이벤트를 감지하고 모달에 CSV 데이터를 불러와서 표시하는 함수
     document.getElementById('KB증권').addEventListener('click', async function() {
    const response = await fetch('../static/data/증권사상품.csv'); // CSV 파일 경로
    const csvData = await response.text();
    
    // CSV 데이터를 파싱하여 배열로 변환
    const rows = csvData.split('\n').map(row => row.split(','));

    // 특정 조건에 맞는 데이터 필터링 (예: Product ID가 1인 경우)
    const filteredRows = rows.filter(row => row[1] === 'KB증권'); // 첫 번째 열이 Product ID
    // 모달에 테이블로 데이터 출력
    const modalBody = document.getElementById('modalBody');
    modalBody.innerHTML = '';

    filteredRows.forEach(row => {
        const newRow = document.createElement('tr');
        newRow.innerHTML = `<td>${row[1]}</td><td>${row[2]}</td><td>${row[4]}</td><td>${row[5]}</td><td>${row[6]}</td><td>${row[7]}</td><td>${row[3]}</td>`;
        modalBody.appendChild(newRow);
    });
    // 모달 표시
    $('#productModal').modal('show');
    });


    // KB증권 버튼 클릭 이벤트를 감지하고 모달에 CSV 데이터를 불러와서 표시하는 함수
    document.getElementById('신한투자증권').addEventListener('click', async function() {
    const response = await fetch('../static/data/증권사상품.csv'); // CSV 파일 경로
    const csvData = await response.text();
    
    // CSV 데이터를 파싱하여 배열로 변환
    const rows = csvData.split('\n').map(row => row.split(','));

    // 특정 조건에 맞는 데이터 필터링 (예: Product ID가 1인 경우)
    const filteredRows = rows.filter(row => row[1] === '신한투자증권'); // 첫 번째 열이 Product ID
    // 모달에 테이블로 데이터 출력
    const modalBody = document.getElementById('modalBody');
    modalBody.innerHTML = '';

    filteredRows.forEach(row => {
        const newRow = document.createElement('tr');
        newRow.innerHTML = `<td>${row[1]}</td><td>${row[2]}</td><td>${row[4]}</td><td>${row[5]}</td><td>${row[6]}</td><td>${row[7]}</td><td>${row[3]}</td>`;
        modalBody.appendChild(newRow);
    });
    // 모달 표시
    $('#productModal').modal('show');
    });

    </script>


{% endblock %}